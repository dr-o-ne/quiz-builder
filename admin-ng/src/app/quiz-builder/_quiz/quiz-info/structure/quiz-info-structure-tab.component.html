<div id="quiz-info-structure">

    <div class="structure" 
        fxLayout="column" 
        fxLayoutAlign="center" 
        [@animateStagger]="{value:'50'}" 
        cdkDropList 
        [cdkDropListData]="dataInfos" 
        (cdkDropListDropped)="dropGroup($event)">

        <div *ngFor="let dataInfo of dataInfos" class="groups" [@animate]="{value:'*',params:{y:'100%'}}" cdkDrag>

            <div class="group" fxLayout="column" fxFlex="1 1 auto" >

                <div class="header accent" fxLayout="row" fxLayoutAlign="center center"                             >

                    <div class="category" fxFlex>
                        <button mat-raised-button [matMenuTriggerFor]="addQuestionMenu">
                            <span>ADD QUESTION</span>
                        </button>
                        <mat-menu #addQuestionMenu="matMenu">
                            <button mat-menu-item *ngFor="let questionType of questionTypeKeys; let i = index"
                                (click)="addQuestion(dataInfo.id, questionType)">
                                {{questionLangService.getQuestionTypeLangTerm(questionType)}}
                            </button>
                        </mat-menu>

                        <button mat-icon-button matTooltip="Reorder Groups">
                            <mat-icon cdkDragHandle>drag_indicator</mat-icon>
                        </button>

                        <div fxFlex></div>

                    </div>

                </div>

                <mat-table id={{dataInfo.id}} [dataSource]="dataInfo.dataSource" cdkDropList
                    [cdkDropListData]="dataInfo.dataSource.data" [cdkDropListConnectedTo]="getConnectedList()"
                    (cdkDropListDropped)="dropQuestion($event)">
            
                    <ng-container matColumnDef="name">
                    <mat-header-cell *matHeaderCellDef> Question </mat-header-cell>
                    <mat-cell *matCellDef="let element" (click)="onEditClick(element)">{{getDisplayName(element)}}</mat-cell>
                    </ng-container>
            
                    <ng-container matColumnDef="type" >
                    <mat-header-cell *matHeaderCellDef> Type </mat-header-cell>
                    <mat-cell *matCellDef="let element" (click)="onEditClick(element)">{{questionLangService.getQuestionTypeLangTerm(element.type)}}</mat-cell>
                    </ng-container>
            
                    <ng-container matColumnDef="delete">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button [matMenuTriggerFor]="menu">
                        <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="deleteQuestion(dataInfo.id, element.id)" fxFlex="nogrow">
                            <mat-icon>delete</mat-icon>
                            <span>Delete Question</span>
                        </button>
                        </mat-menu>
                    </td>
                    </ng-container>
            
                    <mat-header-row *matHeaderRowDef="displayedColumns" style="visibility: hidden"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayedColumns;" cdkDrag class="hover:bg-hover cursor-pointer"></mat-row>
                </mat-table>

            </div>

        </div>

    </div>

</div>
